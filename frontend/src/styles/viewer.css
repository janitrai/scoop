@keyframes translation-progress-sweep {
  0% {
    transform: translateX(-120%);
  }

  100% {
    transform: translateX(320%);
  }
}

@keyframes translation-dot-pulse {
  0%,
  100% {
    opacity: 0.35;
    transform: scale(0.88);
  }

  50% {
    opacity: 1;
    transform: scale(1);
  }
}

@layer components {
  .controls {
    @apply mb-4 p-[14px];
  }

  .controls-top-row {
    @apply grid grid-cols-[minmax(300px,380px)_minmax(0,1fr)] items-start gap-2.5;
  }

  .finder-row {
    @apply grid grid-cols-[minmax(0,1fr)_2.5rem] items-stretch gap-0;
  }

  .finder-input-wrap {
    @apply flex min-h-10 items-center gap-2 rounded-[10px] border border-panel-500 bg-panel-600 px-2.5;
  }

  .finder-input-wrap:focus-within {
    @apply border-brand-500 ring-2 ring-brand-500/35;
  }

  .finder-icon {
    @apply font-mono text-[0.82rem] font-bold text-panel-400;
  }

  .finder-input {
    @apply w-full text-[0.84rem] text-panel-100;
  }

  .finder-clear-btn {
    @apply text-panel-400;
  }

  .finder-clear-btn:hover {
    @apply text-panel-100;
  }

  .finder-advanced-icon {
    @apply inline-flex h-10 w-10 shrink-0 items-center justify-center rounded-[10px] border border-panel-500 bg-panel-600 p-0 text-panel-400 outline-none transition-colors duration-150;
    line-height: 1;
    overflow: visible;
  }

  .finder-advanced-icon svg {
    @apply h-5 w-5 stroke-current;
    display: block;
    overflow: visible;
  }

  .finder-advanced-icon:hover {
    @apply border-brand-500/60 text-panel-100;
  }

  .finder-advanced-icon:focus-visible {
    @apply text-brand-400 ring-2 ring-brand-500/35;
  }

  .finder-advanced-icon.active {
    @apply text-brand-400;
  }

  .advanced-row {
    @apply mt-2.5 grid grid-cols-[minmax(120px,180px)_minmax(120px,180px)] gap-2.5;
  }

  .advanced-field-control {
    @apply flex items-center gap-1.5;
  }

  .advanced-day-trigger {
    @apply h-10 w-full justify-start rounded-[10px] border border-panel-500 bg-panel-600 px-2.5 text-left text-[0.82rem] font-normal text-panel-100 shadow-none;
  }

  .advanced-day-trigger:hover {
    @apply border-brand-500/60;
  }

  .advanced-day-trigger:focus-visible {
    @apply border-brand-500/60 ring-2 ring-brand-500/35;
  }

  .advanced-day-trigger-label {
    @apply block max-w-full truncate;
  }

  .advanced-day-clear {
    @apply h-10 w-10 shrink-0 rounded-[10px] border border-panel-500 bg-panel-600 p-0 text-panel-400;
  }

  .advanced-day-clear:hover {
    @apply border-brand-500/60 text-panel-100;
  }

  .chips-row {
    @apply mt-3 flex flex-wrap gap-2;
  }

  .chip {
    @apply cursor-pointer rounded-full border border-panel-500 bg-panel-600 px-2.5 py-[7px] text-[0.78rem] font-bold tracking-[0.02em] text-panel-100;
  }

  .chip.active {
    @apply border-brand-500 bg-brand-500/20 text-panel-100;
  }

  .chip:disabled {
    @apply cursor-not-allowed opacity-45;
  }

  .day-strip {
    @apply mt-0;
  }

  .day-nav {
    @apply grid grid-cols-[auto_minmax(0,1fr)_auto] items-center gap-2;
  }

  .day-nav-btn {
    @apply inline-flex h-10 w-10 min-w-[40px] items-center justify-center rounded-full border border-panel-500 bg-panel-700 p-0 text-panel-100;
  }

  .day-nav-btn:hover {
    @apply border-brand-500/60;
  }

  .day-nav-icon {
    @apply h-4 w-4;
  }

  .day-current-btn {
    @apply min-h-10 w-full cursor-pointer rounded-xl border border-panel-500 bg-panel-600 px-3 py-1.5 text-panel-100;
    @apply flex items-center justify-center;
  }

  .day-current-line {
    @apply block max-w-full truncate text-center font-display text-[0.9rem] font-bold tracking-[0.01em];
  }

  .day-current-btn:hover {
    @apply border-brand-500/60;
  }

  .day-current-btn:focus {
    @apply border-brand-500/60 ring-2 ring-brand-500/35;
  }

  .day-popover {
    @apply w-auto border-panel-500 bg-panel-800 p-1.5;
  }

  .topbar-day {
    @apply w-[clamp(260px,30vw,420px)] max-w-full flex-none;
  }

  .layout {
    @apply min-h-0 flex-1 overflow-hidden;
  }

  .layout-panels {
    @apply h-full min-h-0 w-full;
  }

  .layout-panels > [data-panel] {
    @apply min-h-0 min-w-0;
    display: flex;
  }

  .layout-resize-handle {
    @apply bg-panel-500 transition-colors duration-150;
  }

  .layout-resize-handle.horizontal {
    width: 1px;
    cursor: col-resize;
  }

  .layout-resize-handle.vertical {
    height: 2px;
    cursor: row-resize;
  }

  .layout-resize-handle:hover,
  .layout-resize-handle:focus,
  .layout-resize-handle[data-resize-handle-active] {
    @apply bg-brand-500 outline-none;
  }

  .panel {
    @apply flex h-full min-h-0 flex-col p-[14px];
  }

  .panel-header {
    @apply mb-2.5 flex items-start justify-between gap-[14px];
  }

  .panel h2 {
    @apply m-0 font-display text-[1.2rem];
  }

  .feed-search {
    @apply px-3 py-2;
  }

  .story-feed-panel {
    @apply relative;
  }

  .stories-list-wrap {
    @apply relative flex min-h-0 flex-1 flex-col;
  }

  .stories-list,
  .detail-content {
    @apply min-h-0 flex-1 overflow-y-auto;
    @apply flex flex-col;
    scrollbar-gutter: stable both-edges;
  }

  .stories-list {
    @apply gap-2.5 pr-1 pb-16;
  }

  .detail-content {
    @apply gap-2.5 pr-1;
  }

  .stories-load-sentinel {
    @apply h-4 w-full;
  }

  .stories-status {
    @apply mb-0 mt-1;
  }

  .feed-count-overlay {
    @apply pointer-events-none absolute bottom-12 left-1/2 -translate-x-1/2 rounded-full border border-panel-500 bg-panel-900/90 px-2.5 py-1 font-mono text-[0.62rem] font-bold text-panel-400;
  }

  .story-card {
    @apply cursor-pointer rounded-xl border border-panel-500 bg-panel-700 p-3 transition duration-100 ease-out;
  }

  .story-card:hover {
  }

  .story-card.active {
    @apply border-brand-500/80 ring-1 ring-brand-500/60;
  }

  .story-title-row {
    @apply flex items-start justify-between gap-2;
  }

  .story-title-flags {
    @apply inline-flex shrink-0 items-center gap-1.5;
  }

  .story-title {
    @apply m-0 font-news text-[0.93rem] leading-[1.3];
  }

  .story-translation-badge {
    @apply inline-flex shrink-0 rounded-full border border-brand-500/40 bg-brand-500/10 px-1.5 py-0.5 font-mono text-[0.62rem] font-bold text-brand-400;
  }

  .story-language-badge {
    @apply inline-flex shrink-0 rounded-full border border-panel-500 bg-panel-600 px-1.5 py-0.5 font-mono text-[0.62rem] font-semibold text-panel-400;
  }

  .story-translating-indicator {
    @apply inline-flex items-center gap-1 rounded-full border border-brand-500/25 bg-brand-500/10 px-1.5 py-0.5 font-mono text-[0.6rem] font-semibold uppercase tracking-[0.05em] text-brand-400;
  }

  .story-translating-dot {
    @apply h-1.5 w-1.5 rounded-full bg-brand-400;
    animation: translation-dot-pulse 1.1s ease-in-out infinite;
  }

  .story-meta {
    @apply mb-0 mt-1.5 font-mono text-[0.72rem] text-panel-400;
  }

  .detail-meta {
    @apply m-0 font-mono text-[0.8rem] text-panel-400;
  }

  .detail-title-row {
    @apply flex items-start gap-2.5;
  }

  .detail-title {
    @apply m-0 font-news text-[1.08rem] leading-[1.3] text-panel-100;
  }

  .detail-language-badge {
    @apply inline-flex shrink-0 rounded-full border border-panel-500 bg-panel-700 px-2 py-0.5 font-mono text-[0.62rem] font-semibold text-panel-400;
  }

  .detail-title-original {
    @apply m-0 text-[0.74rem] text-panel-400;
  }

  .sidebar-user {
    @apply relative mt-2.5 border-t border-panel-500 px-3 pt-3;
  }

  .sidebar-user-trigger {
    @apply flex w-full items-center gap-2 rounded-[10px] border border-panel-500 bg-panel-700 px-2.5 py-2 text-left text-panel-100;
  }

  .sidebar-user-trigger:hover {
    @apply border-brand-500/60;
  }

  .sidebar-user-bubble {
    @apply inline-flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-brand-500/20 font-mono text-[0.72rem] font-bold text-brand-400;
  }

  .sidebar-user-name {
    @apply min-w-0 flex-1 truncate text-[0.82rem] font-medium;
  }

  .sidebar-user-chevron {
    @apply h-4 w-4 shrink-0 text-panel-400 transition-transform duration-150;
  }

  .sidebar-user-chevron.open {
    transform: rotate(180deg);
  }

  .sidebar-user-menu {
    @apply absolute right-3 bottom-[calc(100%+0.45rem)] z-20 grid min-w-[170px] gap-1 rounded-[10px] border border-panel-500 bg-panel-800 p-1 shadow-panel;
  }

  .sidebar-user-menu-item {
    @apply inline-flex items-center gap-2 rounded-[8px] px-2.5 py-2 text-left text-[0.8rem] text-panel-100;
  }

  .sidebar-user-menu-item:hover {
    @apply bg-panel-700;
  }

  .detail-text-mode-toggle {
    @apply mb-1.5 mt-1 flex items-center gap-1;
  }

  .detail-text-mode-btn {
    @apply rounded-full border border-panel-500 bg-panel-700 px-2 py-1 text-[0.68rem] font-mono text-panel-400;
  }

  .detail-text-mode-btn.active {
    @apply border-brand-500/60 bg-brand-500/15 text-panel-100;
  }

  .translation-progress {
    @apply mb-1.5 rounded-[10px] border border-brand-500/35 bg-brand-500/10 px-2.5 py-2;
  }

  .translation-progress-track {
    @apply relative h-1.5 overflow-hidden rounded-full bg-panel-700/90;
  }

  .translation-progress-bar {
    @apply absolute inset-y-0 rounded-full;
    left: 0;
    width: 34%;
    background: linear-gradient(90deg, rgba(248, 165, 80, 0.15), rgba(248, 165, 80, 0.95), rgba(248, 165, 80, 0.15));
    animation: translation-progress-sweep 1.35s ease-in-out infinite;
  }

  .translation-progress-label {
    @apply mb-0 mt-2 font-mono text-[0.7rem] text-brand-400;
  }

  .member-grid {
    @apply grid gap-2;
  }

  .member-card {
    @apply rounded-[10px] border border-panel-500 bg-panel-650 p-2.5;
  }

  .member-card-expanded {
    @apply bg-brand-500/5;
  }

  .member-toggle {
    @apply inline-flex max-w-full items-start gap-1.5 border-0 bg-transparent p-0 text-left;
  }

  .member-toggle-icon {
    @apply mt-0.5 h-4 w-4 shrink-0 text-panel-400 transition-colors duration-150;
  }

  .member-toggle:hover .member-head,
  .member-toggle:hover .member-toggle-icon {
    @apply text-brand-400;
  }

  .member-toggle:focus-visible {
    @apply outline-none;
  }

  .member-toggle:focus-visible .member-head,
  .member-toggle:focus-visible .member-toggle-icon {
    @apply text-brand-400;
  }

  .member-head {
    @apply m-0 font-news text-[0.86rem] font-semibold;
  }

  .member-preview {
    @apply mb-0 mt-1.5 text-[0.84rem] leading-[1.45] text-panel-100/85;
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .member-sub {
    @apply mb-0 mt-1.5 font-mono text-[0.74rem] text-panel-400;
  }

  .member-decision-inline {
    @apply lowercase;
  }

  .detail-item-content {
    @apply mt-2 rounded-[10px] border border-panel-500 bg-panel-700/50 p-3;
  }

  .detail-item-content-body {
    @apply grid gap-3;
  }

  .detail-item-content-mode-hint {
    @apply mb-2 mt-0 text-[0.7rem] font-mono text-panel-400;
  }

  .detail-text-block {
    @apply rounded-[8px] border border-panel-500/60 px-2.5 py-2.5;
  }

  .detail-text-block-original {
    @apply bg-panel-700/40;
  }

  .detail-text-block-translated {
    @apply border-brand-500/40 bg-brand-500/10;
  }

  .detail-text-label {
    @apply mb-1.5 mt-0 text-[0.68rem] font-mono uppercase tracking-[0.06em] text-panel-400;
  }

  .detail-item-content-text {
    @apply m-0 text-[0.92rem] leading-[1.55] text-panel-100;
    word-break: break-word;
    overflow-wrap: anywhere;
  }

  .member-expanded-url {
    @apply mt-2 block w-full max-w-full overflow-hidden text-ellipsis whitespace-nowrap break-normal text-[0.92rem] leading-tight text-brand-400 no-underline;
  }

  .member-expanded-url:hover {
    @apply text-panel-100;
  }

  .member-expanded-content {
    @apply mt-2 rounded-none border-0 bg-transparent p-0;
  }

  .member-merge-provenance {
    @apply mt-3 grid gap-1.5;
  }

  .member-merge-provenance-title {
    @apply m-0 font-mono text-[0.72rem] uppercase tracking-[0.08em] text-panel-400;
  }

  .member-merge-provenance-list {
    @apply m-0 grid list-none gap-2 p-0;
  }

  .member-merge-provenance-row {
    @apply rounded-[8px] bg-panel-700/45 px-2.5 py-2;
  }

  .member-merge-provenance-row.is-selected {
    @apply bg-brand-500/15;
  }

  .member-merge-provenance-link {
    @apply w-full border-0 bg-transparent p-0 text-left font-mono text-[0.74rem] text-panel-400;
  }

  .member-merge-provenance-link:hover {
    @apply text-panel-100;
  }

  .member-merge-provenance-link:focus-visible {
    @apply outline-none text-brand-400;
  }

  .decision-pill {
    @apply mt-1.5 inline-block rounded-full px-2 py-1 text-[0.67rem] font-extrabold uppercase tracking-[0.08em];
  }

  .decision-auto_merge {
    @apply bg-emerald-400/20 text-emerald-300;
  }

  .decision-new_story,
  .decision-gray_zone {
    @apply bg-amber-300/20 text-amber-200;
  }

  .app-root-viewer .controls,
  .app-root-viewer .banner-error {
    @apply mb-0 border-x-0 border-t-0 border-b border-panel-500 px-3 py-2 shadow-none;
  }

  .app-root-viewer .topbar {
    @apply mb-0 border-x-0 border-t-0 border-b border-panel-500 shadow-none;
  }

  .app-root-viewer .layout {
    @apply gap-0;
  }

  .app-root-viewer .layout-panels {
    @apply border-t-0;
  }

  .app-root-viewer .panel.card {
    @apply rounded-none border-0 bg-transparent shadow-none;
  }

  .app-root-viewer .panel {
    @apply p-0;
  }

  .app-root-viewer .panel-header {
    @apply mb-0 border-b border-panel-500 px-3 py-2;
  }

  .app-root-viewer .controls-top-row {
    @apply grid-cols-1 gap-0;
  }

  .app-root-viewer .controls-top-row > * + * {
    @apply border-l border-panel-500;
  }

  .app-root-viewer .finder-row {
    @apply gap-2;
  }

  .app-root-viewer .day-nav-btn {
    @apply rounded-full;
  }

  .app-root-viewer .advanced-row {
    @apply mt-2 gap-2;
  }

  .app-root-viewer .advanced-day-trigger,
  .app-root-viewer .advanced-day-clear {
    @apply rounded-none;
  }

  .app-root-viewer .feed-search {
    @apply sticky top-0 z-10 bg-panel-900 pl-3 pr-2 pt-2.5 pb-2;
  }

  .app-root-viewer .chips-row {
    @apply mt-0 border-t border-panel-500;
  }

  .app-root-viewer .chip {
    @apply rounded-none border-x-0 border-t-0 border-b border-panel-500 px-3;
  }

  .app-root-viewer .chip.active {
    @apply border-brand-500 bg-brand-500/30 text-panel-100;
  }

  .app-root-viewer .stories-list {
    @apply gap-1 pb-16 pl-1 pr-3;
    scrollbar-gutter: auto;
  }

  .app-root-viewer .detail-content {
    @apply gap-0 pb-2 pr-0;
  }

  .app-root-viewer .stories-list::-webkit-scrollbar,
  .app-root-viewer .detail-content::-webkit-scrollbar {
    width: 8px;
  }

  .app-root-viewer .stories-list::-webkit-scrollbar-thumb,
  .app-root-viewer .detail-content::-webkit-scrollbar-thumb {
    @apply bg-panel-500;
  }

  .app-root-viewer .stories-list::-webkit-scrollbar-track,
  .app-root-viewer .detail-content::-webkit-scrollbar-track {
    @apply bg-transparent;
  }

  .app-root-viewer .story-card {
    @apply mx-0 rounded-[10px] border border-transparent bg-transparent px-2 py-2;
  }

  .app-root-viewer .story-card:hover {
    @apply bg-brand-500/15;
  }

  .app-root-viewer .story-card.active {
    @apply border-transparent bg-brand-500/20 shadow-none ring-0;
  }

  .app-root-viewer .story-meta,
  .app-root-viewer .member-sub,
  .app-root-viewer .decision-pill {
    @apply mt-1;
  }

  .app-root-viewer .member-grid {
    @apply mt-1 gap-0 px-0;
  }

  .app-root-viewer .member-card {
    @apply rounded-none border-0 bg-transparent px-5 py-4;
  }

  .app-root-viewer .member-card.member-card-expanded {
    @apply bg-brand-500/5;
  }

  .app-root-viewer .member-card > * {
    @apply px-0;
  }

  .app-root-viewer .member-toggle:hover .member-head,
  .app-root-viewer .member-toggle:hover .member-toggle-icon,
  .app-root-viewer .member-toggle:focus-visible .member-head,
  .app-root-viewer .member-toggle:focus-visible .member-toggle-icon {
    @apply text-brand-400;
  }

  .app-root-viewer .member-preview {
    @apply mt-1.5;
  }

  .app-root-viewer .member-preview-collapsed {
    @apply mb-0;
  }

  .app-root-viewer .detail-item-content {
    @apply mx-5 mb-4 mt-2 rounded-[12px] border border-panel-500 bg-panel-800/80 p-4;
  }

  .app-root-viewer .detail-item-content-text {
    @apply text-[0.94rem] leading-[1.6];
  }

  .app-root-viewer .member-expanded-url {
    @apply px-0 py-1;
  }

  .app-root-viewer .member-expanded-content {
    @apply mx-0 mb-0 mt-2 rounded-none border-0 bg-transparent p-0;
  }

  .app-root-viewer .member-merge-provenance {
    @apply mt-2;
  }

  .app-root-viewer .member-merge-provenance-row {
    @apply rounded-[8px] bg-panel-800/60 px-3 py-2;
  }

  .app-root-viewer .detail-content > * {
    @apply px-5;
  }

  .app-root-viewer .detail-content > .detail-item-content {
    @apply px-0;
  }

  .app-root-viewer .detail-content > .member-grid {
    @apply px-0;
  }

  .app-root-viewer .detail-title {
    @apply p-4;
  }

  .app-root-viewer .detail-meta,
  .app-root-viewer .stories-list > .muted,
  .app-root-viewer .detail-content > .muted,
  .app-root-viewer .stories-status {
    @apply px-5 py-3;
  }

  .app-root-viewer .stories-load-sentinel,
  .app-root-viewer .stories-status {
    @apply border-0;
  }

  .app-root-viewer .stories-load-sentinel {
    @apply h-px;
  }

  .app-root-viewer .topbar-left,
  .app-root-viewer .topbar-copy {
    @apply min-w-0;
  }

  .app-root-viewer .topbar-title {
    @apply truncate;
  }
}
